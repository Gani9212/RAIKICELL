<!DOCTYPE html>
<html lang="id">
<head>
<meta charset="UTF-8" />
<meta name="viewport" content="width=device-width, initial-scale=1" />
<title>POS Kasir Usaha</title>
<style>
  body {
    font-family: Arial, sans-serif;
    margin: 0; padding: 0;
    display: flex;
    height: 100vh;
    overflow: hidden;
    background: #f5f5f5;
  }
  #sidebar {
    width: 230px;
    background: #2c3e50;
    color: white;
    display: flex;
    flex-direction: column;
  }
  #sidebar h2 {
    margin: 20px;
    font-weight: normal;
  }
  #sidebar button {
    background: none;
    border: none;
    color: white;
    padding: 15px 20px;
    text-align: left;
    font-size: 16px;
    cursor: pointer;
    border-left: 5px solid transparent;
    transition: background 0.3s, border-color 0.3s;
  }
  #sidebar button.active, #sidebar button:hover {
    background: #34495e;
    border-left-color: #e67e22;
  }
  #content {
    flex-grow: 1;
    overflow-y: auto;
    padding: 20px;
    background: white;
  }
  h3 {
    margin-top: 0;
  }
  form {
    margin-bottom: 20px;
  }
  label {
    display: block;
    margin-top: 10px;
    font-weight: bold;
  }
  input[type=text], input[type=number], input[type=date] {
    width: 100%;
    padding: 6px 8px;
    margin-top: 4px;
    box-sizing: border-box;
    border-radius: 4px;
    border: 1px solid #ccc;
    font-size: 14px;
  }
  input[type=number]::-webkit-inner-spin-button,
  input[type=number]::-webkit-outer-spin-button {
    -webkit-appearance: none;
    margin: 0;
  }
  button.submit-btn {
    margin-top: 15px;
    padding: 10px 15px;
    background: #27ae60;
    border: none;
    color: white;
    font-size: 15px;
    border-radius: 4px;
    cursor: pointer;
    transition: background 0.3s;
  }
  button.submit-btn:hover {
    background: #219150;
  }
  table {
    width: 100%;
    border-collapse: collapse;
    margin-top: 10px;
  }
  table thead {
    background: #2980b9;
    color: white;
  }
  table th, table td {
    padding: 8px 10px;
    border: 1px solid #ddd;
    text-align: left;
    font-size: 14px;
  }
  table tbody tr:nth-child(even) {
    background: #f9f9f9;
  }
  .delete-button {
    background: #e74c3c;
    border: none;
    color: white;
    padding: 5px 9px;
    border-radius: 3px;
    cursor: pointer;
    font-size: 13px;
  }
  .delete-button:hover {
    background: #c0392b;
  }
  .info-box {
    margin: 15px 0;
    padding: 10px 15px;
    background: #ecf0f1;
    border-radius: 5px;
    font-weight: bold;
    font-size: 16px;
  }
  .filter-section {
    margin-bottom: 10px;
    display: flex;
    gap: 10px;
    flex-wrap: wrap;
  }
  .filter-section input {
    max-width: 150px;
  }
  @media (max-width: 700px) {
    body {
      flex-direction: column;
      height: auto;
    }
    #sidebar {
      width: 100%;
      flex-direction: row;
      overflow-x: auto;
    }
    #sidebar button {
      flex: 1;
      border-left: none;
      border-bottom: 5px solid transparent;
      text-align: center;
    }
    #sidebar button.active, #sidebar button:hover {
      border-left-color: transparent;
      border-bottom-color: #e67e22;
    }
    #content {
      height: auto;
      padding: 10px;
    }
  }
</style>
</head>
<body>

<div id="sidebar">
  <h2>Menu</h2>
  <button class="tab-btn active" data-tab="konter">Transaksi Konter</button>
  <button class="tab-btn" data-tab="warung">Transaksi Warung</button>
  <button class="tab-btn" data-tab="tarik-tunai">Tarik Tunai</button>
  <button class="tab-btn" data-tab="pengeluaran">Pengeluaran</button>
  <button class="tab-btn" data-tab="admin">Admin (Barang)</button>
  <button class="tab-btn" data-tab="laporan">Laporan</button>
</div>

<div id="content">

  <!-- Transaksi Konter -->
  <section class="tab-content" id="konter" style="display:block;">
    <h3>Transaksi Konter</h3>
    <form id="formKonter">
      <label>Nama Barang</label>
      <input type="text" id="namaBarangKonter" required placeholder="Nama barang" autocomplete="off" />
      <label>Harga</label>
      <input type="number" id="hargaKonter" required min="0" />
      <label>Fee</label>
      <input type="number" id="feeKonter" required min="0" />
      <button class="submit-btn" type="submit">Tambah Transaksi</button>
    </form>
    <table id="tableKonter">
      <thead>
        <tr>
          <th>Nama Barang</th>
          <th>Harga</th>
          <th>Fee</th>
          <th>Tanggal</th>
          <th>Aksi</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </section>

  <!-- Transaksi Warung -->
  <section class="tab-content" id="warung" style="display:none;">
    <h3>Transaksi Warung</h3>
    <form id="formWarung">
      <label>Nama Barang</label>
      <input type="text" id="namaBarangWarung" required placeholder="Nama barang" autocomplete="off" />
      <label>Harga</label>
      <input type="number" id="hargaWarung" required min="0" />
      <label>Fee</label>
      <input type="number" id="feeWarung" required min="0" />
      <button class="submit-btn" type="submit">Tambah Transaksi</button>
    </form>
    <table id="tableWarung">
      <thead>
        <tr>
          <th>Nama Barang</th>
          <th>Harga</th>
          <th>Fee</th>
          <th>Tanggal</th>
          <th>Aksi</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </section>

  <!-- Tarik Tunai -->
  <section class="tab-content" id="tarik-tunai" style="display:none;">
    <h3>Transaksi Tarik Tunai</h3>
    <form id="formTarikTunai">
      <label>Jumlah Tarik Tunai</label>
      <input type="number" id="jumlahTarikTunai" required min="0" />
      <label>Fee</label>
      <input type="number" id="feeTarikTunai" required min="0" />
      <button class="submit-btn" type="submit">Tambah Tarik Tunai</button>
    </form>
    <table id="tableTarikTunai">
      <thead>
        <tr>
          <th>Jumlah</th>
          <th>Fee</th>
          <th>Tanggal</th>
          <th>Aksi</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </section>

  <!-- Pengeluaran -->
  <section class="tab-content" id="pengeluaran" style="display:none;">
    <h3>Pengeluaran</h3>
    <form id="formPengeluaran">
      <label>Nama Pengeluaran</label>
      <input type="text" id="namaPengeluaran" required placeholder="Nama pengeluaran" autocomplete="off" />
      <label>Jumlah</label>
      <input type="number" id="jumlahPengeluaran" required min="0" />
      <button class="submit-btn" type="submit">Tambah Pengeluaran</button>
    </form>
    <table id="tablePengeluaran">
      <thead>
        <tr>
          <th>Nama Pengeluaran</th>
          <th>Jumlah</th>
          <th>Tanggal</th>
          <th>Aksi</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </section>

  <!-- Admin Barang -->
  <section class="tab-content" id="admin" style="display:none;">
    <h3>Admin - Daftar Barang</h3>
    <form id="formAdmin">
      <label>Nama Barang</label>
      <input type="text" id="namaBarangAdmin" required placeholder="Nama barang" autocomplete="off" />
      <label>Harga</label>
      <input type="number" id="hargaAdmin" required min="0" />
      <button class="submit-btn" type="submit">Tambah Barang</button>
    </form>
    <table id="tableAdmin">
      <thead>
        <tr>
          <th>Nama Barang</th>
          <th>Harga</th>
          <th>Aksi</th>
        </tr>
      </thead>
      <tbody></tbody>
    </table>
  </section>

  <!-- Laporan -->
  <section class="tab-content" id="laporan" style="display:none;">
    <h3>Laporan Keuangan</h3>
    <div class="filter-section">
      <label>Dari: <input type="date" id="filterStart" /></label>
      <label>Sampai: <input type="date" id="filterEnd" /></label>
      <button id="filterBtn">Filter</button>
      <button id="clearFilterBtn">Reset</button>
    </div>
    <div class="info-box" id="infoPendapatan">Total Pendapatan: Rp 0</div>
    <div class="info-box" id="infoPengeluaran">Total Pengeluaran: Rp 0</div>
    <div class="info-box" id="infoKeuntungan">Keuntungan Bersih: Rp 0</div>
  </section>

</div>

<!-- Firebase SDK -->
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-app-compat.js"></script>
<script src="https://www.gstatic.com/firebasejs/9.22.2/firebase-database-compat.js"></script>

<script>
  // Firebase config
  const firebaseConfig = {
    apiKey: "AIzaSyDORXKZfPNQFe9Z2tZuwfveWPHgH8WyqGE",
    authDomain: "raikicell.firebaseapp.com",
    databaseURL: "https://raikicell-default-rtdb.firebaseio.com",
    projectId: "raikicell",
    storageBucket: "raikicell.appspot.com",
    messagingSenderId: "648628376778",
    appId: "1:648628376778:web:961ca9084abeeb206bd033"
  };

  // Initialize Firebase
  firebase.initializeApp(firebaseConfig);
  const db = firebase.database();

  // Utility function to generate unique IDs for entries
  function generateId() {
    return Date.now().toString() + Math.floor(Math.random() * 1000).toString();
  }

  // Handle sidebar tab switch
  const tabs = document.querySelectorAll('.tab-btn');
  const tabContents = document.querySelectorAll('.tab-content');

  tabs.forEach(tab => {
    tab.addEventListener('click', () => {
      tabs.forEach(t => t.classList.remove('active'));
      tab.classList.add('active');

      const target = tab.getAttribute('data-tab');
      tabContents.forEach(tc => {
        tc.style.display = (tc.id === target) ? 'block' : 'none';
      });
    });
  });

  // --- Transaksi Konter ---
  const formKonter = document.getElementById('formKonter');
  const tableKonterBody = document.querySelector('#tableKonter tbody');

  function renderKonterData(data) {
    tableKonterBody.innerHTML = '';
    if (!data) return;
    Object.keys(data).forEach(id => {
      const item = data[id];
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${item.namaBarang}</td>
        <td>Rp ${item.harga.toLocaleString()}</td>
        <td>Rp ${item.fee.toLocaleString()}</td>
        <td>${new Date(item.tanggal).toLocaleDateString()}</td>
        <td><button class="delete-button" data-id="${id}" data-type="konter">Hapus</button></td>
      `;
      tableKonterBody.appendChild(tr);
    });
  }

  function loadKonter() {
    db.ref('konter').once('value', snapshot => {
      const data = snapshot.val();
      renderKonterData(data);
    });
  }

  formKonter.addEventListener('submit', e => {
    e.preventDefault();
    const namaBarang = document.getElementById('namaBarangKonter').value.trim();
    const harga = Number(document.getElementById('hargaKonter').value);
    const fee = Number(document.getElementById('feeKonter').value);
    if (!namaBarang || harga < 0 || fee < 0) {
      alert('Data tidak valid');
      return;
    }
    const id = generateId();
    const tanggal = Date.now();
    db.ref('konter/' + id).set({ namaBarang, harga, fee, tanggal }, error => {
      if (error) alert('Gagal simpan data');
      else {
        formKonter.reset();
        loadKonter();
        loadLaporan();
      }
    });
  });

  // --- Transaksi Warung ---
  const formWarung = document.getElementById('formWarung');
  const tableWarungBody = document.querySelector('#tableWarung tbody');

  function renderWarungData(data) {
    tableWarungBody.innerHTML = '';
    if (!data) return;
    Object.keys(data).forEach(id => {
      const item = data[id];
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${item.namaBarang}</td>
        <td>Rp ${item.harga.toLocaleString()}</td>
        <td>Rp ${item.fee.toLocaleString()}</td>
        <td>${new Date(item.tanggal).toLocaleDateString()}</td>
        <td><button class="delete-button" data-id="${id}" data-type="warung">Hapus</button></td>
      `;
      tableWarungBody.appendChild(tr);
    });
  }

  function loadWarung() {
    db.ref('warung').once('value', snapshot => {
      const data = snapshot.val();
      renderWarungData(data);
    });
  }

  formWarung.addEventListener('submit', e => {
    e.preventDefault();
    const namaBarang = document.getElementById('namaBarangWarung').value.trim();
    const harga = Number(document.getElementById('hargaWarung').value);
    const fee = Number(document.getElementById('feeWarung').value);
    if (!namaBarang || harga < 0 || fee < 0) {
      alert('Data tidak valid');
      return;
    }
    const id = generateId();
    const tanggal = Date.now();
    db.ref('warung/' + id).set({ namaBarang, harga, fee, tanggal }, error => {
      if (error) alert('Gagal simpan data');
      else {
        formWarung.reset();
        loadWarung();
        loadLaporan();
      }
    });
  });

  // --- Tarik Tunai ---
  const formTarikTunai = document.getElementById('formTarikTunai');
  const tableTarikTunaiBody = document.querySelector('#tableTarikTunai tbody');

  function renderTarikTunaiData(data) {
    tableTarikTunaiBody.innerHTML = '';
    if (!data) return;
    Object.keys(data).forEach(id => {
      const item = data[id];
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>Rp ${item.jumlah.toLocaleString()}</td>
        <td>Rp ${item.fee.toLocaleString()}</td>
        <td>${new Date(item.tanggal).toLocaleDateString()}</td>
        <td><button class="delete-button" data-id="${id}" data-type="tarik-tunai">Hapus</button></td>
      `;
      tableTarikTunaiBody.appendChild(tr);
    });
  }

  function loadTarikTunai() {
    db.ref('tarik-tunai').once('value', snapshot => {
      const data = snapshot.val();
      renderTarikTunaiData(data);
    });
  }

  formTarikTunai.addEventListener('submit', e => {
    e.preventDefault();
    const jumlah = Number(document.getElementById('jumlahTarikTunai').value);
    const fee = Number(document.getElementById('feeTarikTunai').value);
    if (jumlah < 0 || fee < 0) {
      alert('Data tidak valid');
      return;
    }
    const id = generateId();
    const tanggal = Date.now();
    db.ref('tarik-tunai/' + id).set({ jumlah, fee, tanggal }, error => {
      if (error) alert('Gagal simpan data');
      else {
        formTarikTunai.reset();
        loadTarikTunai();
        loadLaporan();
      }
    });
  });

  // --- Pengeluaran ---
  const formPengeluaran = document.getElementById('formPengeluaran');
  const tablePengeluaranBody = document.querySelector('#tablePengeluaran tbody');

  function renderPengeluaranData(data) {
    tablePengeluaranBody.innerHTML = '';
    if (!data) return;
    Object.keys(data).forEach(id => {
      const item = data[id];
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${item.namaPengeluaran}</td>
        <td>Rp ${item.jumlah.toLocaleString()}</td>
        <td>${new Date(item.tanggal).toLocaleDateString()}</td>
        <td><button class="delete-button" data-id="${id}" data-type="pengeluaran">Hapus</button></td>
      `;
      tablePengeluaranBody.appendChild(tr);
    });
  }

  function loadPengeluaran() {
    db.ref('pengeluaran').once('value', snapshot => {
      const data = snapshot.val();
      renderPengeluaranData(data);
    });
  }

  formPengeluaran.addEventListener('submit', e => {
    e.preventDefault();
    const namaPengeluaran = document.getElementById('namaPengeluaran').value.trim();
    const jumlah = Number(document.getElementById('jumlahPengeluaran').value);
    if (!namaPengeluaran || jumlah < 0) {
      alert('Data tidak valid');
      return;
    }
    const id = generateId();
    const tanggal = Date.now();
    db.ref('pengeluaran/' + id).set({ namaPengeluaran, jumlah, tanggal }, error => {
      if (error) alert('Gagal simpan data');
      else {
        formPengeluaran.reset();
        loadPengeluaran();
        loadLaporan();
      }
    });
  });

  // --- Admin Barang ---
  const formAdmin = document.getElementById('formAdmin');
  const tableAdminBody = document.querySelector('#tableAdmin tbody');

  function renderAdminData(data) {
    tableAdminBody.innerHTML = '';
    if (!data) return;
    Object.keys(data).forEach(id => {
      const item = data[id];
      const tr = document.createElement('tr');
      tr.innerHTML = `
        <td>${item.namaBarang}</td>
        <td>Rp ${item.harga.toLocaleString()}</td>
        <td><button class="delete-button" data-id="${id}" data-type="admin">Hapus</button></td>
      `;
      tableAdminBody.appendChild(tr);
    });
  }

  function loadAdmin() {
    db.ref('admin').once('value', snapshot => {
      const data = snapshot.val();
      renderAdminData(data);
    });
  }

  formAdmin.addEventListener('submit', e => {
    e.preventDefault();
    const namaBarang = document.getElementById('namaBarangAdmin').value.trim();
    const harga = Number(document.getElementById('hargaAdmin').value);
    if (!namaBarang || harga < 0) {
      alert('Data tidak valid');
      return;
    }
    const id = generateId();
    db.ref('admin/' + id).set({ namaBarang, harga }, error => {
      if (error) alert('Gagal simpan data');
      else {
        formAdmin.reset();
        loadAdmin();
      }
    });
  });

  // --- Delete data handler ---
  document.body.addEventListener('click', e => {
    if (e.target.classList.contains('delete-button')) {
      const id = e.target.getAttribute('data-id');
      const type = e.target.getAttribute('data-type');
      if (confirm('Yakin ingin menghapus data?')) {
        db.ref(type + '/' + id).remove(error => {
          if (error) alert('Gagal hapus data');
          else {
            if (type === 'konter') loadKonter();
            else if (type === 'warung') loadWarung();
            else if (type === 'tarik-tunai') loadTarikTunai();
            else if (type === 'pengeluaran') loadPengeluaran();
            else if (type === 'admin') loadAdmin();
            loadLaporan();
          }
        });
      }
    }
  });

  // --- Laporan ---
  const infoPendapatan = document.getElementById('infoPendapatan');
  const infoPengeluaran = document.getElementById('infoPengeluaran');
  const infoKeuntungan = document.getElementById('infoKeuntungan');
  const filterStart = document.getElementById('filterStart');
  const filterEnd = document.getElementById('filterEnd');
  const filterBtn = document.getElementById('filterBtn');
  const clearFilterBtn = document.getElementById('clearFilterBtn');

  async function loadLaporan() {
    // ambil semua data transaksi dan pengeluaran
    const [konterSnap, warungSnap, tarikTunaiSnap, pengeluaranSnap] = await Promise.all([
      db.ref('konter').once('value'),
      db.ref('warung').once('value'),
      db.ref('tarik-tunai').once('value'),
      db.ref('pengeluaran').once('value')
    ]);

    const konterData = konterSnap.val() || {};
    const warungData = warungSnap.val() || {};
    const tarikTunaiData = tarikTunaiSnap.val() || {};
    const pengeluaranData = pengeluaranSnap.val() || {};

    let pendapatan = 0;
    let totalPengeluaran = 0;

    // Filter tanggal jika ada
    const startDate = filterStart.value ? new Date(filterStart.value).setHours(0,0,0,0) : null;
    const endDate = filterEnd.value ? new Date(filterEnd.value).setHours(23,59,59,999) : null;

    function isInRange(timestamp) {
      if (!startDate && !endDate) return true;
      if (startDate && endDate) return timestamp >= startDate && timestamp <= endDate;
      if (startDate) return timestamp >= startDate;
      if (endDate) return timestamp <= endDate;
      return true;
    }

    // Pendapatan dari Konter
    Object.values(konterData).forEach(item => {
      if (isInRange(item.tanggal)) {
        pendapatan += item.harga + item.fee;
      }
    });

    // Pendapatan dari Warung
    Object.values(warungData).forEach(item => {
      if (isInRange(item.tanggal)) {
        pendapatan += item.harga + item.fee;
      }
    });

    // Kurangi Tarik Tunai dari pendapatan
    Object.values(tarikTunaiData).forEach(item => {
      if (isInRange(item.tanggal)) {
        pendapatan -= item.jumlah + item.fee;
      }
    });

    // Total pengeluaran
    Object.values(pengeluaranData).forEach(item => {
      if (isInRange(item.tanggal)) {
        totalPengeluaran += item.jumlah;
      }
    });

    infoPendapatan.textContent = `Total Pendapatan: Rp ${pendapatan.toLocaleString()}`;
    infoPengeluaran.textContent = `Total Pengeluaran: Rp ${totalPengeluaran.toLocaleString()}`;
    infoKeuntungan.textContent = `Keuntungan Bersih: Rp ${(pendapatan - totalPengeluaran).toLocaleString()}`;
  }

  filterBtn.addEventListener('click', e => {
    e.preventDefault();
    loadLaporan();
  });

  clearFilterBtn.addEventListener('click', e => {
    filterStart.value = '';
    filterEnd.value = '';
    loadLaporan();
  });

  // Load all data initially
  loadKonter();
  loadWarung();
  loadTarikTunai();
  loadPengeluaran();
  loadAdmin();
  loadLaporan();
  );

  // Form tarik tunai submit
  document.getElementById('formTarikTunai').addEventListener('submit', e => {
    e.preventDefault();
    const jumlah = parseInt(document.getElementById('jumlahTarikTunai').value);
    const fee = parseInt(document.getElementById('feeTarikTunai').value);
    if (isNaN(jumlah) || isNaN(fee) || jumlah < 0 || fee < 0) return alert('Input tidak valid!');
    tarikTunai.push({
      jumlah, fee,
      tanggal: new Date().toISOString().slice(0,10)
    });
    saveData();
    renderAll();
    e.target.reset();
  });

  // Form pengeluaran submit
  document.getElementById('formPengeluaran').addEventListener('submit', e => {
    e.preventDefault();
    const nama = document.getElementById('namaPengeluaran').value.trim();
    const jumlah = parseInt(document.getElementById('jumlahPengeluaran').value);
    if (!nama || isNaN(jumlah) || jumlah < 0) return alert('Input tidak valid!');
    pengeluaran.push({
      nama, jumlah,
      tanggal: new Date().toISOString().slice(0,10)
    });
    saveData();
    renderAll();
    e.target.reset();
  });

  // Form admin barang submit
  document.getElementById('formAdmin').addEventListener('submit', e => {
    e.preventDefault();
    const nama = document.getElementById('namaBarangAdmin').value.trim();
    const harga = parseInt(document.getElementById('hargaAdmin').value);
    const fee = parseInt(document.getElementById('feeAdmin').value);
    if (!nama || isNaN(harga) || isNaN(fee) || harga < 0 || fee < 0) return alert('Input tidak valid!');
    daftarBarangAdmin.push({nama, harga, fee});
    saveData();
    renderAll();
    e.target.reset();
  });

  // Delete button event delegation
  document.body.addEventListener('click', e => {
    if (e.target.classList.contains('delete-button')) {
      const idx = parseInt(e.target.dataset.index);
      const type = e.target.dataset.type;
      deleteItem(type, idx);
    }
  });

  // Search barang admin
  document.getElementById('searchBarang').addEventListener('input', e => {
    renderTableAdmin(e.target.value);
  });

  // Laporan harian generate
  document.getElementById('btnGenerateLaporanHarian').addEventListener('click', () => {
    const tanggal = document.getElementById('tanggalLaporanHarian').value;
    if (!tanggal) return alert('Pilih tanggal terlebih dahulu');
    let labaKotor = 0;
    let labaBersih = 0;

    // Hitung berdasarkan transaksi hari itu
    transaksiKonter.forEach(d => {
      if (d.tanggal === tanggal) {
        labaKotor += d.harga + d.fee;
        labaBersih += d.fee;
      }
    });
    transaksiWarung.forEach(d => {
      if (d.tanggal === tanggal) {
        labaKotor += d.harga + d.fee;
        labaBersih += d.fee;
      }
    });
    pengeluaran.forEach(d => {
      if (d.tanggal === tanggal) {
        labaKotor -= d.jumlah;
      }
    });
    tarikTunai.forEach(d => {
      if (d.tanggal === tanggal) {
        labaKotor -= d.jumlah;
        labaBersih += d.fee;
      }
    });

    const hasil = `Laba Kotor: ${formatRupiah(labaKotor)} | Laba Bersih: ${formatRupiah(labaBersih)}`;
    document.getElementById('laporanHarianResult').textContent = hasil;
  });

  // Laporan bulanan generate
  document.getElementById('btnGenerateLaporanBulanan').addEventListener('click', () => {
    const bulan = document.getElementById('bulanLaporanBulanan').value;
    if (!bulan) return alert('Pilih bulan terlebih dahulu');

    // bulan format yyyy-mm
    let labaKotor = 0;
    let labaBersih = 0;

    function isInMonth(dateStr) {
      return dateStr.startsWith(bulan);
    }

    transaksiKonter.forEach(d => {
      if (isInMonth(d.tanggal)) {
        labaKotor += d.harga + d.fee;
        labaBersih += d.fee;
      }
    });
    transaksiWarung.forEach(d => {
      if (isInMonth(d.tanggal)) {
        labaKotor += d.harga + d.fee;
        labaBersih += d.fee;
      }
    });
    pengeluaran.forEach(d => {
      if (isInMonth(d.tanggal)) {
        labaKotor -= d.jumlah;
      }
    });
    tarikTunai.forEach(d => {
      if (isInMonth(d.tanggal)) {
        labaKotor -= d.jumlah;
        labaBersih += d.fee;
      }
    });

    const hasil = `Laba Kotor Bulanan: ${formatRupiah(labaKotor)} | Laba Bersih Bulanan: ${formatRupiah(labaBersih)}`;
    document.getElementById('laporanBulananResult').textContent = hasil;
  });

  // Init load
  loadData();
  renderAll();
})();
</script>
<!-- LOGIN OVERLAY -->
<style>
  #loginOverlay {
    position: fixed; top:0; left:0; width:100%; height:100%;
    background: rgba(0,0,0,0.6);
    display: flex; justify-content: center; align-items: center;
    z-index: 9999;
  }
  #loginBox {
    background: white; padding: 20px; border-radius: 8px; width: 300px;
    box-shadow: 0 0 10px rgba(0,0,0,0.3);
    font-family: Arial, sans-serif;
  }
  #loginBox input {
    width: 100%; margin: 10px 0; padding: 10px; box-sizing: border-box;
  }
  #loginBox button {
    width: 100%; padding: 10px; background: #4CAF50; color: white;
    border: none; cursor: pointer;
  }
  #loginBox button:hover {
    background: #45a049;
  }
  #errorMsg {
    color: red; font-size: 0.9em; height: 1.2em;
  }
  body.not-logged-in > *:not(#loginOverlay) {
    display: none !important;
  }
</style>

<div id="loginOverlay">
  <div id="loginBox">
    <h2>Login</h2>
    <input type="text" id="username" placeholder="Username" autocomplete="off" />
    <input type="password" id="password" placeholder="Password" autocomplete="off" />
    <button id="loginBtn">Login</button>
    <div id="errorMsg"></div>
  </div>
</div>

<script>
  // User & pass yang diberikan
  const validUsername = "AE366813";
  const validPassword = "Raikicell1909";

  const loginOverlay = document.getElementById('loginOverlay');
  const errorMsg = document.getElementById('errorMsg');
  const loginBtn = document.getElementById('loginBtn');

  // Tampilkan login overlay dan sembunyikan isi asli sampai login benar
  document.body.classList.add('not-logged-in');

  loginBtn.addEventListener('click', () => {
    const username = document.getElementById('username').value.trim();
    const password = document.getElementById('password').value;

    if (username === validUsername && password === validPassword) {
      // Login sukses
      document.body.classList.remove('not-logged-in');
      loginOverlay.style.display = 'none';
      sessionStorage.setItem('loggedIn', 'true');
    } else {
      errorMsg.textContent = 'Username atau password salah!';
    }
  });

  // Jika sudah login sebelumnya, langsung sembunyikan login
  if (sessionStorage.getItem('loggedIn') === 'true') {
    document.body.classList.remove('not-logged-in');
    loginOverlay.style.display = 'none';
  }
</script>

</body>
</html>
